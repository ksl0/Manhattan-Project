{% extends 'workflow_base.html' %}

{% block title_block %}
    <title>{{ article.title }}</title>
{% endblock %}

{% block breadcrumb %}
    <ol class="breadcrumb breadcrumbAdjust">
        <li><a href="{% url 'issues' %}">Issues</a></li>
        <li><a href="{% url 'issue' article.issue.pk %}">Issue {{ article.issue.name }}</a></li>
        <li class="active">{{ article.title }}</li>
    </ol>
{% endblock %}

{% block content_block %}
    <div class="article_block">
        {% include 'articles/workflow_long_article_partial.html' %}
    </div>
    <div class="comment_block">
        {% include 'articles/comments_partial.html' %}
    </div>
    <div class="revision_block">
        {% include 'articles/revision_list_partial.html' %}
    </div>
{% endblock %}

{% block additional_scripts_block %}
    <script>
        pub_but = '<a class="btn btn-default btn-success btn-30" href="javascript:void(0)" ' +
        'id="pub_but" onclick="pub();">Publish</a>'
        unpub_but = '<a class="btn btn-default btn-warning btn-30" href="javascript:void(0)" ' +
        'id="unpub_but" onclick="unpub();">Unpublish</a>'
        function pub(){
            $.ajax({
                url:'/workflow/pub/{{ article.id }}',
                success: function(){
                    $('#pub_but').replaceWith(unpub_but);
                },
                error: function(xhr,message,exception){
                    alert('error occurs: '+ exception);
                }
            })
        }
      function unpub(){
            $.ajax({
                url:'/workflow/pub/{{ article.id }}',
                success: function(){
                    $('#unpub_but').replaceWith(pub_but);
                },
                error: function(xhr,message,exception){
                    alert('error occurs: '+ exception);
                }
            })
        }

    </script>
{% endblock %}